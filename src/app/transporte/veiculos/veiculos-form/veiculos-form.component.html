<div id="content">
    <div class="container">
        <app-buttons
                [title]="(routeParams.id)?'EDITAR ':'CADASTRAR ' + 'TIPO DE DOCUMENTO' "
                [hidebuttons]="buttons"
                [icon]="(routeParams.id)?'zmdi zmdi-edit':'zmdi zmdi-assignment'"
                (eventsave)="updateOrCreate(saveForm.value)">
        </app-buttons>
        <div class="card">
            <div class="card-body card-padding">
                <div id="documentos" class="pmb-block">
                    <div class="card-header pmbb-header" style="margin: 0;">
                        <h2><i class="zmdi zmdi-car m-r-10"></i> Veículo</h2>
                    </div>
                    <div class="card-body">
                        <form [formGroup]="saveForm" (ngSubmit)="updateOrCreate(saveForm.value)">
                            <div class="row-large m-t-10">
                                <div class="col-xs-4" >
                                    <div class="fg-line">
                                        <label>Usuário - Atualmente ({{veiculo?.usuario_nome}})</label>
                                        <p-autoComplete
                                                placeholder="Contratante"
                                                minLength="3"
                                                delay="600"
                                                field="name"
                                                [suggestions]="usuarios?.data"
                                                (completeMethod)="search($event)"
                                                [dropdown]="false"
                                                (onSelect)="selectdItem($event)"
                                                (onDropdownClick)="handleDropdown($event)">
                                            <ng-template let-usuario pTemplate="item">
                                                <div class="card-body">
                                                    <div class="list-group">
                                                        <a class="list-group-item media" style="padding: 0;">
                                                            <div class="pull-left">
                                                                <img class="lgi-img" src="{{usuario.imagem}}" alt="">
                                                            </div>
                                                            <div class="media-body">
                                                                <div class="lgi-heading">{{usuario.name}}</div>
                                                                <small class="lgi-text">{{usuario.cpf_cnpj}}</small>
                                                                <small class="lgi-text">{{usuario.email}}</small>
                                                            </div>
                                                        </a>
                                                    </div>
                                                </div>
                                            </ng-template>
                                        </p-autoComplete>
                                    </div>
                                    <app-error-message [erros]="saveForm.controls['user_id']"></app-error-message>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Marca</label>
                                        <!--<input type="text" [formControl]="saveForm.controls['marca']" class="form-control" placeholder="Ex: Fiat">-->
                                        <p-dropdown [formControl]="saveForm.controls['transporte_marca_carro_id']"
                                                    filter="filter" [options]="marcasCarro"
                                                    (onChange)="loadModelos($event)"
                                                    placeholder="Selecione a marca"></p-dropdown>
                                    </div>
                                    <app-error-message
                                            [erros]="saveForm.controls['transporte_marca_carro_id']"></app-error-message>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Modelo</label>
                                        <!--<input type="text" class="form-control" [formControl]="saveForm.controls['modelo']" placeholder="Ex: Uno">-->
                                        <p-dropdown [formControl]="saveForm.controls['transporte_modelo_carro_id']"
                                                    filter="filter" [options]="modelosCarro"
                                                    placeholder="Selecione o modelo"></p-dropdown>
                                    </div>
                                    <app-error-message
                                            [erros]="saveForm.controls['transporte_modelo_carro_id']"></app-error-message>
                                </div>
                            </div>
                            <div class="row-large m-t-10">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Ano</label>
                                        <input type="text" class="form-control"
                                               [formControl]="saveForm.controls['ano']" placeholder="Ex: 2010">
                                    </div>
                                    <app-error-message [erros]="saveForm.controls['ano']"></app-error-message>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Placa do veículo</label>
                                        <input type="text" [formControl]="saveForm.controls['placa']"
                                               class="form-control" placeholder="Ex: mmm000">
                                    </div>
                                    <app-error-message [erros]="saveForm.controls['placa']"></app-error-message>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Cor do veículo</label>
                                        <!--<input type="text" class="form-control" [formControl]="saveForm.controls['cor']" placeholder="Ex: preto">-->
                                        <p-dropdown [formControl]="saveForm.controls['cor']" [options]="cores"
                                                    placeholder="Selecione a cor"></p-dropdown>
                                    </div>
                                    <app-error-message [erros]="saveForm.controls['cor']"></app-error-message>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Cor do veículo</label>
                                        <!--<input type="text" class="form-control" [formControl]="saveForm.controls['cor']" placeholder="Ex: preto">-->
                                        <p-dropdown [formControl]="saveForm.controls['status']" [options]="status"
                                                    placeholder="Selecione a cor"></p-dropdown>
                                    </div>
                                    <app-error-message [erros]="saveForm.controls['status']"></app-error-message>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="card-header pmbb-header" style="margin: 0;">
                        <h2 class="btn-clicle-middle m-b-10">
                            <button (click)="addDocumento()" class="btn bgm-green waves-circle" type="submit"><i class="zmdi zmdi-plus"></i></button>
                            Documentos
                        </h2>
                        <div class="m-b-25" [formGroup]="saveForm">
                            <div class="row-large m-t-25" *ngFor="let documento of saveForm.controls['documentos'].controls; let i=index">
                                <div class="col-xs-6">
                                    <label>
                                        Tipo do Documento:
                                    </label>
                                    <!--<input type="text" class="form-control input-sm" [formControl]="documento.controls['transporte_tipo_documento_id']" placeholder="Ex. 63">-->
                                    <p-dropdown  placeholder="Selecione o Tipo do Documento" [options]="tipoDocumentos" [formControl]="documento.controls['transporte_tipo_documento_id']"></p-dropdown>
                                    <app-error-message [erros]="documento.controls['transporte_tipo_documento_id']"></app-error-message>
                                </div>
                                <div class="col-xs-4">
                                    <label>
                                        Arquivo:
                                    </label>
                                    <input type="file" class="form-control input-sm" multiple accept="image/*" (change)="changeListenerVeiculo(documento, $event)" >
                                    <app-error-message [erros]="documento.controls['arquivos']"></app-error-message>
                                </div>
                                <div class="col-xs-2 center-itens">
                                    <button (click)="delDocumento(i)" class="btn bgm-green waves-effect" type="button"><i class="zmdi zmdi-close"></i></button>
                                </div>
                            </div>
                        </div>
                        <h2 class="btn-clicle-middle m-b-10">
                            <i class="zmdi zmdi-file m-r-10"></i>
                            Documentos inseridos
                        </h2>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                <tr>
                                    <th>Tipo do Arquivo</th>
                                    <th>Quantidade de Arquivos</th>
                                    <th>Remover</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let item of veiculo?.documentos?.data; let i=index">
                                    <td>{{item.tipo}}</td>
                                    <td>{{item?.arquivos?.data.length}}</td>
                                    <td class="center">
                                        <button (click)="removeDocumento(item.id, i)" class="btn bgm-green waves-effect" type="button"><i class="zmdi zmdi-close"></i></button>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
